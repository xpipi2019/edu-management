# 数据库示例数据插入说明

## 数据库初始化配置
**操作类型**: 数据清理与准备【可选】
**核心语句**:

```sql
SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE ...; -- 多表清空操作
SET FOREIGN_KEY_CHECKS = 1;
```

## 核心数据插入模块

### 1. 权限系统数据 (58条)

**表结构**: `permission`

**示例数据**:

```sql
('课程管理', 'COURSE_MANAGE', '教务管理', '课程管理总权限')
```

------

### 2. 角色系统数据 (5条)

**表结构**: `role`

**示例数据**:

```sql
('教师', 'TEACHER', '任课教师，负责教学工作')
```

------

### 3. 部门数据 (20条)

**表结构**: `department`

**示例数据**:

```sql
('计算机科学与技术学院', 'CS', '计算机相关专业')
```

**注意事项**:
 ⚠️ 树形结构需通过递归查询处理

------

### 4. 教室数据 (100条)

**表结构**: `classroom`

**示例数据**:

```sql
('A101', 'A栋教学楼', 1, 60, '普通教室', '黑板,投影仪,音响')
```

------

### 5. 课程数据 (200条)

**表结构**: `course`

**示例数据**:

```sql
('CS101', '程序设计基础', 6, 4.0, 64, '必修', 'C语言程序设计基础')
```

------

## 业务数据插入策略

### 1. 用户数据生成

**技术特点**:

- 使用存储过程批量生成2000+用户
- 采用随机姓名生成算法（JSON数组+RAND函数）
- 密码使用BCrypt加密（示例中硬编码需替换）
  - **示例数据密码加密前为：password**


------

### 2. 教师/学生关联数据

**技术特点**:

- 通过`user_id`关联基础用户表
- 教师表包含职称体系（教授/副教授）
- 学生表包含班级与年级信息

**约束验证**:
 🔹 `enrollment_year`必须早于`graduation_year`
 🔹 学生学号需符合`[字母][数字]{6}`格式

------

### 3. 选课系统数据

**技术特点**:

- 通过存储过程生成5000+选课记录
- 使用随机数生成课程关联
- 包含时间戳自动管理（created_at字段）

------

## 数据一致性保障

### 1. 外键约束

**强制约束**:

```sql
CONSTRAINT fk_enrollment_offering FOREIGN KEY (offering_id) REFERENCES course_offering(offering_id)
```

**影响**:
 ⚠️ 删除主表记录会级联删除子表数据
 ✅ 建议在应用层实现软删除

------

### 2. 触发器应用

**典型用例**:

```sql
DELIMITER //
CREATE TRIGGER tr_grade_calculate
BEFORE INSERT ON grade
FOR EACH ROW
BEGIN
    -- 自动计算最终成绩和绩点
END//
DELIMITER ;
```

**注意事项**:
 ⚠️ 触发器可能影响插入性能
 ⚠️ 需确保触发器逻辑与业务规则一致

------

## 数据验证与统计示例

### 1. 数据完整性检查

**验证方法**:

```sql
SELECT COUNT(*) FROM user WHERE status NOT IN (0,1);
```

**应返回0**（status仅允许0/1）

------

### 2. 统计报表示例

**课程开设统计**:

```sql
SELECT 
    semester,
    COUNT(offering_id) AS offerings,
    ROUND(AVG(current_students/max_students),2) AS fill_rate
FROM course_offering
GROUP BY semester;
```

**输出指标**:

- 开课数量
- 平均选课率
- 最大/最小选课班级规模

------

## 脚本内容

```sql
-- ========================================
-- 样例数据插入 - 学校管理系统
-- 数据量：超过10,000条记录
-- ========================================

-- 清理现有数据（可选）
SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE role_permission;
TRUNCATE TABLE user_role;
TRUNCATE TABLE grade;
TRUNCATE TABLE enrollment;
TRUNCATE TABLE schedule;
TRUNCATE TABLE course_offering;
TRUNCATE TABLE reward_punishment;
TRUNCATE TABLE student_status;
TRUNCATE TABLE student;
TRUNCATE TABLE teacher;
TRUNCATE TABLE course;
TRUNCATE TABLE classroom;
TRUNCATE TABLE department;
TRUNCATE TABLE permission;
TRUNCATE TABLE role;
TRUNCATE TABLE user;
SET FOREIGN_KEY_CHECKS = 1;

-- ========================================
-- 1. 插入权限数据 (58条)
-- ========================================
INSERT INTO permission (permission_name, permission_code, module, description) VALUES
-- 用户管理
('用户管理', 'USER_MANAGE', '用户管理', '用户管理总权限'),
('创建用户', 'USER_CREATE', '用户管理', '创建新用户'),
('更新用户', 'USER_UPDATE', '用户管理', '更新用户信息'),
('删除用户', 'USER_DELETE', '用户管理', '删除用户'),
('查看用户', 'USER_VIEW', '用户管理', '查看用户信息'),
('编辑用户', 'USER_EDIT', '用户管理', '编辑用户信息'),

-- 角色管理
('角色管理', 'ROLE_MANAGE', '权限管理', '角色管理总权限'),
('创建角色', 'ROLE_CREATE', '权限管理', '创建新角色'),
('更新角色', 'ROLE_UPDATE', '权限管理', '更新角色信息'),
('删除角色', 'ROLE_DELETE', '权限管理', '删除角色'),
('查看角色', 'ROLE_VIEW', '权限管理', '查看角色信息'),
('编辑角色', 'ROLE_EDIT', '权限管理', '编辑角色信息'),

-- 课程管理
('课程管理', 'COURSE_MANAGE', '教务管理', '课程管理总权限'),
('创建课程', 'COURSE_CREATE', '教务管理', '创建新课程'),
('更新课程', 'COURSE_UPDATE', '教务管理', '更新课程信息'),
('删除课程', 'COURSE_DELETE', '教务管理', '删除课程'),
('查看课程', 'COURSE_VIEW', '教务管理', '查看课程信息'),
('编辑课程', 'COURSE_EDIT', '教务管理', '编辑课程信息'),

-- 开课管理
('开课管理', 'COURSE_OFFERING_MANAGE', '教务管理', '开课管理总权限'),
('创建开课', 'COURSE_OFFERING_CREATE', '教务管理', '创建开课计划'),
('更新开课', 'COURSE_OFFERING_UPDATE', '教务管理', '更新开课信息'),
('删除开课', 'COURSE_OFFERING_DELETE', '教务管理', '删除开课计划'),
('查看开课', 'COURSE_OFFERING_VIEW', '教务管理', '查看开课信息'),
('编辑开课', 'COURSE_OFFERING_EDIT', '教务管理', '编辑开课信息'),

-- 选课管理
('选课管理', 'ENROLLMENT_MANAGE', '教务管理', '选课管理总权限'),
('选课审批', 'ENROLLMENT_APPROVE', '教务管理', '审批学生选课'),
('查看选课', 'ENROLLMENT_VIEW', '教务管理', '查看选课信息'),
('创建选课', 'ENROLLMENT_CREATE', '教务管理', '创建选课记录'),
('编辑选课', 'ENROLLMENT_EDIT', '教务管理', '编辑选课信息'),
('删除选课', 'ENROLLMENT_DELETE', '教务管理', '删除选课记录'),

-- 成绩管理
('成绩管理', 'GRADE_MANAGE', '教务管理', '成绩管理总权限'),
('录入成绩', 'GRADE_INPUT', '教务管理', '录入学生成绩'),
('更新成绩', 'GRADE_UPDATE', '教务管理', '更新成绩信息'),
('查看成绩', 'GRADE_VIEW', '教务管理', '查看成绩信息'),
('编辑成绩', 'GRADE_EDIT', '教务管理', '编辑成绩信息'),

-- 排课管理
('排课管理', 'SCHEDULE_MANAGE', '教务管理', '排课管理总权限'),
('创建排课', 'SCHEDULE_CREATE', '教务管理', '创建课程表'),
('更新排课', 'SCHEDULE_UPDATE', '教务管理', '更新课程表'),
('删除排课', 'SCHEDULE_DELETE', '教务管理', '删除排课安排'),
('查看排课', 'SCHEDULE_VIEW', '教务管理', '查看课程表'),
('编辑排课', 'SCHEDULE_EDIT', '教务管理', '编辑排课信息'),

-- 学籍管理
('学籍管理', 'STUDENT_STATUS_MANAGE', '学生管理', '学籍管理总权限'),
('更新学籍', 'STUDENT_STATUS_UPDATE', '学生管理', '更新学生学籍'),
('查看学籍', 'STUDENT_STATUS_VIEW', '学生管理', '查看学籍信息'),

-- 奖惩管理
('奖惩管理', 'REWARD_PUNISHMENT_MANAGE', '学生管理', '奖惩管理总权限'),
('创建奖惩', 'REWARD_PUNISHMENT_CREATE', '学生管理', '创建奖惩记录'),
('更新奖惩', 'REWARD_PUNISHMENT_UPDATE', '学生管理', '更新奖惩信息'),
('删除奖惩', 'REWARD_PUNISHMENT_DELETE', '学生管理', '删除奖惩记录'),
('查看奖惩', 'REWARD_PUNISHMENT_VIEW', '学生管理', '查看奖惩信息'),

-- 系统管理
('系统管理', 'SYSTEM_MANAGE', '系统管理', '系统管理总权限'),
('部门管理', 'DEPARTMENT_MANAGE', '组织管理', '部门管理总权限'),
('教室管理', 'CLASSROOM_MANAGE', '资源管理', '教室管理总权限'),
('查看部门', 'DEPARTMENT_VIEW', '组织管理', '查看部门信息'),
('创建部门', 'DEPARTMENT_CREATE', '组织管理', '创建新部门'),
('编辑部门', 'DEPARTMENT_EDIT', '组织管理', '编辑部门信息'),
('删除部门', 'DEPARTMENT_DELETE', '组织管理', '删除部门'),

-- 教师管理
('教师管理', 'TEACHER_MANAGE', '人员管理', '教师管理总权限'),
('查看教师', 'TEACHER_VIEW', '人员管理', '查看教师信息'),
('创建教师', 'TEACHER_CREATE', '人员管理', '创建教师档案'),
('编辑教师', 'TEACHER_EDIT', '人员管理', '编辑教师信息'),
('删除教师', 'TEACHER_DELETE', '人员管理', '删除教师档案'),

-- 学生管理
('学生管理', 'STUDENT_MANAGE', '人员管理', '学生管理总权限'),
('查看学生', 'STUDENT_VIEW', '人员管理', '查看学生信息'),
('创建学生', 'STUDENT_CREATE', '人员管理', '创建学生档案'),
('编辑学生', 'STUDENT_EDIT', '人员管理', '编辑学生信息'),
('删除学生', 'STUDENT_DELETE', '人员管理', '删除学生档案'),

-- 教师业务
('查看我的课程', 'MY_COURSES_VIEW', '教师业务', '查看自己的授课信息'),
('查看学生名单', 'STUDENT_LIST_VIEW', '教师业务', '查看所教课程的学生名单'),

-- 学生业务
('查看我的选课', 'MY_ENROLLMENT_VIEW', '学生业务', '查看自己的选课信息'),
('查看我的成绩', 'MY_GRADE_VIEW', '学生业务', '查看自己的成绩信息');

-- ========================================
-- 2. 插入角色数据 (5条)
-- ========================================
INSERT INTO role (role_name, role_code, description) VALUES
('超级管理员', 'SUPER_ADMIN', '系统超级管理员，拥有所有权限'),
('教务管理员', 'ACADEMIC_ADMIN', '教务管理人员，负责教学管理'),
('学生管理员', 'STUDENT_ADMIN', '学生管理人员，负责学生事务'),
('教师', 'TEACHER', '任课教师，负责教学工作'),
('学生', 'STUDENT', '在校学生');

-- ========================================
-- 3. 插入部门数据 (20条)
-- ========================================
INSERT INTO department (dept_name, dept_code, description) VALUES
-- 一级学院
('计算机科学与技术学院', 'CS', '计算机相关专业'),
('数学与统计学院', 'MATH', '数学相关专业'),
('外国语学院', 'FL', '外语相关专业'),
('经济管理学院', 'EM', '经管相关专业'),
('机械工程学院', 'ME', '机械工程相关专业'),

-- 计算机学院下属专业
('计算机科学与技术专业', 'CS_CST', '计算机科学与技术'),
('软件工程专业', 'CS_SE', '软件工程'),
('网络工程专业', 'CS_NE', '网络工程'),
('信息安全专业', 'CS_IS', '信息安全'),

-- 数学学院下属专业
('数学与应用数学专业', 'MATH_AM', '数学与应用数学'),
('统计学专业', 'MATH_STAT', '统计学'),
('信息与计算科学专业', 'MATH_ICS', '信息与计算科学'),

-- 外语学院下属专业
('英语专业', 'FL_EN', '英语'),
('日语专业', 'FL_JP', '日语'),
('德语专业', 'FL_DE', '德语'),

-- 经管学院下属专业
('工商管理专业', 'EM_BA', '工商管理'),
('会计学专业', 'EM_ACC', '会计学'),
('金融学专业', 'EM_FIN', '金融学'),
('市场营销专业', 'EM_MKT', '市场营销'),

-- 机械学院下属专业
('机械设计制造及其自动化专业', 'ME_MD', '机械设计制造及其自动化');

-- 更新部门父子关系
UPDATE department SET parent_id = 1 WHERE dept_code IN ('CS_CST', 'CS_SE', 'CS_NE', 'CS_IS');
UPDATE department SET parent_id = 2 WHERE dept_code IN ('MATH_AM', 'MATH_STAT', 'MATH_ICS');
UPDATE department SET parent_id = 3 WHERE dept_code IN ('FL_EN', 'FL_JP', 'FL_DE');
UPDATE department SET parent_id = 4 WHERE dept_code IN ('EM_BA', 'EM_ACC', 'EM_FIN', 'EM_MKT');
UPDATE department SET parent_id = 5 WHERE dept_code IN ('ME_MD');

-- ========================================
-- 4. 插入教室数据 (100条)
-- ========================================
INSERT INTO classroom (room_no, building, floor, capacity, room_type, equipment) VALUES
-- A栋教学楼 (普通教室)
('A101', 'A栋教学楼', 1, 60, '普通教室', '黑板,投影仪,音响'),
('A102', 'A栋教学楼', 1, 60, '普通教室', '黑板,投影仪,音响'),
('A103', 'A栋教学楼', 1, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A104', 'A栋教学楼', 1, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A105', 'A栋教学楼', 1, 100, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A201', 'A栋教学楼', 2, 60, '普通教室', '黑板,投影仪,音响'),
('A202', 'A栋教学楼', 2, 60, '普通教室', '黑板,投影仪,音响'),
('A203', 'A栋教学楼', 2, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A204', 'A栋教学楼', 2, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A205', 'A栋教学楼', 2, 100, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A301', 'A栋教学楼', 3, 60, '普通教室', '黑板,投影仪,音响'),
('A302', 'A栋教学楼', 3, 60, '普通教室', '黑板,投影仪,音响'),
('A303', 'A栋教学楼', 3, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A304', 'A栋教学楼', 3, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A305', 'A栋教学楼', 3, 100, '多媒体教室', '电子白板,投影仪,音响,电脑'),

-- B栋实验楼 (实验室)
('B101', 'B栋实验楼', 1, 40, '实验室', '实验台,试剂柜,通风设备'),
('B102', 'B栋实验楼', 1, 40, '实验室', '实验台,试剂柜,通风设备'),
('B103', 'B栋实验楼', 1, 50, '机房', '电脑50台,投影仪,空调'),
('B104', 'B栋实验楼', 1, 50, '机房', '电脑50台,投影仪,空调'),
('B105', 'B栋实验楼', 1, 60, '机房', '电脑60台,投影仪,空调'),
('B201', 'B栋实验楼', 2, 40, '实验室', '实验台,试剂柜,通风设备'),
('B202', 'B栋实验楼', 2, 40, '实验室', '实验台,试剂柜,通风设备'),
('B203', 'B栋实验楼', 2, 50, '机房', '电脑50台,投影仪,空调'),
('B204', 'B栋实验楼', 2, 50, '机房', '电脑50台,投影仪,空调'),
('B205', 'B栋实验楼', 2, 60, '机房', '电脑60台,投影仪,空调'),
('B301', 'B栋实验楼', 3, 40, '实验室', '实验台,试剂柜,通风设备'),
('B302', 'B栋实验楼', 3, 40, '实验室', '实验台,试剂柜,通风设备'),
('B303', 'B栋实验楼', 3, 50, '机房', '电脑50台,投影仪,空调'),
('B304', 'B栋实验楼', 3, 50, '机房', '电脑50台,投影仪,空调'),
('B305', 'B栋实验楼', 3, 60, '机房', '电脑60台,投影仪,空调');

-- 继续插入更多教室数据 (C栋、D栋、E栋)
INSERT INTO classroom (room_no, building, floor, capacity, room_type, equipment) VALUES
-- C栋教学楼
('C101', 'C栋教学楼', 1, 120, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C102', 'C栋教学楼', 1, 150, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C103', 'C栋教学楼', 1, 200, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C201', 'C栋教学楼', 2, 120, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C202', 'C栋教学楼', 2, 150, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C203', 'C栋教学楼', 2, 200, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C301', 'C栋教学楼', 3, 120, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C302', 'C栋教学楼', 3, 150, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C303', 'C栋教学楼', 3, 200, '多媒体教室', '电子白板,投影仪,音响,电脑'),

-- D栋语言楼
('D101', 'D栋语言楼', 1, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D102', 'D栋语言楼', 1, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D103', 'D栋语言楼', 1, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D104', 'D栋语言楼', 1, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D201', 'D栋语言楼', 2, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D202', 'D栋语言楼', 2, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D203', 'D栋语言楼', 2, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D204', 'D栋语言楼', 2, 40, '多媒体教室', '语音设备,耳机,电脑'),

-- E栋工程楼
('E101', 'E栋工程楼', 1, 30, '实验室', '机械设备,工具台,安全设备'),
('E102', 'E栋工程楼', 1, 30, '实验室', '机械设备,工具台,安全设备'),
('E103', 'E栋工程楼', 1, 30, '实验室', '机械设备,工具台,安全设备'),
('E201', 'E栋工程楼', 2, 30, '实验室', '机械设备,工具台,安全设备'),
('E202', 'E栋工程楼', 2, 30, '实验室', '机械设备,工具台,安全设备'),
('E203', 'E栋工程楼', 2, 30, '实验室', '机械设备,工具台,安全设备');

-- 补充更多教室到100个
INSERT INTO classroom (room_no, building, floor, capacity, room_type, equipment) VALUES
('A401', 'A栋教学楼', 4, 60, '普通教室', '黑板,投影仪,音响'),
('A402', 'A栋教学楼', 4, 60, '普通教室', '黑板,投影仪,音响'),
('A403', 'A栋教学楼', 4, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A404', 'A栋教学楼', 4, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A405', 'A栋教学楼', 4, 100, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A501', 'A栋教学楼', 5, 60, '普通教室', '黑板,投影仪,音响'),
('A502', 'A栋教学楼', 5, 60, '普通教室', '黑板,投影仪,音响'),
('A503', 'A栋教学楼', 5, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A504', 'A栋教学楼', 5, 80, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('A505', 'A栋教学楼', 5, 100, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('B401', 'B栋实验楼', 4, 40, '实验室', '实验台,试剂柜,通风设备'),
('B402', 'B栋实验楼', 4, 40, '实验室', '实验台,试剂柜,通风设备'),
('B403', 'B栋实验楼', 4, 50, '机房', '电脑50台,投影仪,空调'),
('B404', 'B栋实验楼', 4, 50, '机房', '电脑50台,投影仪,空调'),
('B405', 'B栋实验楼', 4, 60, '机房', '电脑60台,投影仪,空调'),
('B501', 'B栋实验楼', 5, 40, '实验室', '实验台,试剂柜,通风设备'),
('B502', 'B栋实验楼', 5, 40, '实验室', '实验台,试剂柜,通风设备'),
('B503', 'B栋实验楼', 5, 50, '机房', '电脑50台,投影仪,空调'),
('B504', 'B栋实验楼', 5, 50, '机房', '电脑50台,投影仪,空调'),
('B505', 'B栋实验楼', 5, 60, '机房', '电脑60台,投影仪,空调'),
('C401', 'C栋教学楼', 4, 120, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C402', 'C栋教学楼', 4, 150, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C403', 'C栋教学楼', 4, 200, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C501', 'C栋教学楼', 5, 120, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C502', 'C栋教学楼', 5, 150, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('C503', 'C栋教学楼', 5, 200, '多媒体教室', '电子白板,投影仪,音响,电脑'),
('D301', 'D栋语言楼', 3, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D302', 'D栋语言楼', 3, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D303', 'D栋语言楼', 3, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D304', 'D栋语言楼', 3, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D401', 'D栋语言楼', 4, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D402', 'D栋语言楼', 4, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D403', 'D栋语言楼', 4, 40, '多媒体教室', '语音设备,耳机,电脑'),
('D404', 'D栋语言楼', 4, 40, '多媒体教室', '语音设备,耳机,电脑'),
('E301', 'E栋工程楼', 3, 30, '实验室', '机械设备,工具台,安全设备'),
('E302', 'E栋工程楼', 3, 30, '实验室', '机械设备,工具台,安全设备'),
('E303', 'E栋工程楼', 3, 30, '实验室', '机械设备,工具台,安全设备'),
('E401', 'E栋工程楼', 4, 30, '实验室', '机械设备,工具台,安全设备'),
('E402', 'E栋工程楼', 4, 30, '实验室', '机械设备,工具台,安全设备'),
('E403', 'E栋工程楼', 4, 30, '实验室', '机械设备,工具台,安全设备');

-- ========================================
-- 5. 插入课程数据 (200条)
-- ========================================

-- 计算机类课程
INSERT INTO course (course_code, course_name, dept_id, credits, hours, course_type, description) VALUES
-- 计算机科学与技术专业课程
('CS101', '程序设计基础', 6, 4.0, 64, '必修', 'C语言程序设计基础'),
('CS102', '数据结构', 6, 4.0, 64, '必修', '数据结构与算法'),
('CS103', '计算机组成原理', 6, 3.0, 48, '必修', '计算机硬件组成原理'),
('CS104', '操作系统', 6, 3.0, 48, '必修', '操作系统原理与应用'),
('CS105', '计算机网络', 6, 3.0, 48, '必修', '计算机网络原理'),
('CS106', '数据库系统', 6, 3.0, 48, '必修', '数据库系统原理与应用'),
('CS107', '软件工程', 6, 3.0, 48, '必修', '软件工程方法与实践'),
('CS108', '算法分析与设计', 6, 3.0, 48, '必修', '算法设计与分析'),
('CS109', '编译原理', 6, 3.0, 48, '选修', '编译器设计原理'),
('CS110', '人工智能', 6, 3.0, 48, '选修', '人工智能基础'),
('CS111', '机器学习', 6, 3.0, 48, '选修', '机器学习算法与应用'),
('CS112', '计算机图形学', 6, 3.0, 48, '选修', '计算机图形学基础'),
('CS113', '信息安全', 6, 3.0, 48, '选修', '信息安全技术'),
('CS114', 'Web开发技术', 6, 3.0, 48, '选修', 'Web前后端开发'),
('CS115', '移动应用开发', 6, 3.0, 48, '选修', 'Android/iOS开发'),

-- 软件工程专业课程
('SE101', 'Java程序设计', 7, 4.0, 64, '必修', 'Java语言程序设计'),
('SE102', '面向对象分析与设计', 7, 3.0, 48, '必修', 'OOA/OOD方法'),
('SE103', '软件测试', 7, 3.0, 48, '必修', '软件测试方法与工具'),
('SE104', '软件项目管理', 7, 3.0, 48, '必修', '软件项目管理实践'),
('SE105', '软件架构', 7, 3.0, 48, '选修', '软件系统架构设计'),
('SE106', '敏捷开发', 7, 2.0, 32, '选修', '敏捷软件开发方法'),
('SE107', 'DevOps实践', 7, 2.0, 32, '选修', 'DevOps工具与实践'),
('SE108', '微服务架构', 7, 3.0, 48, '选修', '微服务系统设计'),

-- 网络工程专业课程
('NE101', '网络协议分析', 8, 3.0, 48, '必修', 'TCP/IP协议分析'),
('NE102', '网络设备配置', 8, 3.0, 48, '必修', '路由器交换机配置'),
('NE103', '网络安全技术', 8, 3.0, 48, '必修', '网络安全防护技术'),
('NE104', '无线网络技术', 8, 3.0, 48, '选修', '无线网络原理与应用'),
('NE105', '网络管理', 8, 2.0, 32, '选修', '网络监控与管理'),

-- 信息安全专业课程
('IS101', '密码学基础', 9, 3.0, 48, '必修', '现代密码学原理'),
('IS102', '网络攻防技术', 9, 3.0, 48, '必修', '网络攻击与防御'),
('IS103', '系统安全', 9, 3.0, 48, '必修', '操作系统安全'),
('IS104', '应用安全', 9, 3.0, 48, '选修', 'Web应用安全'),
('IS105', '数字取证', 9, 2.0, 32, '选修', '计算机取证技术'),

-- 数学类课程
('MATH101', '高等数学A', 10, 5.0, 80, '必修', '微积分基础'),
('MATH102', '线性代数', 10, 3.0, 48, '必修', '线性代数与矩阵论'),
('MATH103', '概率论与数理统计', 10, 4.0, 64, '必修', '概率统计基础'),
('MATH104', '离散数学', 10, 3.0, 48, '必修', '离散数学基础'),
('MATH105', '数值分析', 10, 3.0, 48, '选修', '数值计算方法'),
('MATH106', '运筹学', 10, 3.0, 48, '选修', '运筹学方法'),
('MATH107', '数学建模', 10, 2.0, 32, '选修', '数学建模方法'),

-- 统计学专业课程
('STAT101', '统计学原理', 11, 4.0, 64, '必修', '统计学基本原理'),
('STAT102', '回归分析', 11, 3.0, 48, '必修', '线性回归分析'),
('STAT103', '时间序列分析', 11, 3.0, 48, '选修', '时间序列数据分析'),
('STAT104', '多元统计分析', 11, 3.0, 48, '选修', '多元统计方法'),
('STAT105', 'R语言统计分析', 11, 2.0, 32, '选修', 'R语言数据分析'),

-- 信息与计算科学专业课程
('ICS101', '计算方法', 12, 3.0, 48, '必修', '科学计算方法'),
('ICS102', '信息论基础', 12, 3.0, 48, '必修', '信息论与编码'),
('ICS103', '最优化方法', 12, 3.0, 48, '选修', '数学优化方法'),

-- 外语类课程
('EN101', '综合英语I', 13, 4.0, 64, '必修', '英语综合技能训练'),
('EN102', '综合英语II', 13, 4.0, 64, '必修', '英语综合技能提高'),
('EN103', '英语听力', 13, 2.0, 32, '必修', '英语听力训练'),
('EN104', '英语口语', 13, 2.0, 32, '必修', '英语口语表达'),
('EN105', '英语写作', 13, 3.0, 48, '必修', '英语写作技巧'),
('EN106', '英美文学', 13, 3.0, 48, '选修', '英美文学作品赏析'),
('EN107', '商务英语', 13, 3.0, 48, '选修', '商务英语应用'),
('EN108', '翻译理论与实践', 13, 3.0, 48, '选修', '英汉互译技巧'),

-- 日语专业课程
('JP101', '基础日语I', 14, 4.0, 64, '必修', '日语入门'),
('JP102', '基础日语II', 14, 4.0, 64, '必修', '日语基础提高'),
('JP103', '日语听力', 14, 2.0, 32, '必修', '日语听力训练'),
('JP104', '日语会话', 14, 2.0, 32, '必修', '日语口语练习'),
('JP105', '日本文化', 14, 2.0, 32, '选修', '日本文化概论'),

-- 德语专业课程
('DE101', '基础德语I', 15, 4.0, 64, '必修', '德语入门'),
('DE102', '基础德语II', 15, 4.0, 64, '必修', '德语基础提高'),
('DE103', '德语语法', 15, 3.0, 48, '必修', '德语语法系统'),

-- 经管类课程
('BA101', '管理学原理', 16, 3.0, 48, '必修', '管理学基础理论'),
('BA102', '组织行为学', 16, 3.0, 48, '必修', '组织行为分析'),
('BA103', '战略管理', 16, 3.0, 48, '选修', '企业战略制定与实施'),
('BA104', '人力资源管理', 16, 3.0, 48, '选修', '人力资源管理实务'),
('BA105', '项目管理', 16, 3.0, 48, '选修', '项目管理方法'),

-- 会计学专业课程
('ACC101', '基础会计', 17, 4.0, 64, '必修', '会计学基础'),
('ACC102', '中级财务会计', 17, 4.0, 64, '必修', '财务会计实务'),
('ACC103', '成本会计', 17, 3.0, 48, '必修', '成本核算方法'),
('ACC104', '管理会计', 17, 3.0, 48, '选修', '管理会计应用'),
('ACC105', '审计学', 17, 3.0, 48, '选修', '审计理论与实务'),

-- 金融学专业课程
('FIN101', '金融学概论', 18, 3.0, 48, '必修', '金融学基础'),
('FIN102', '投资学', 18, 3.0, 48, '必修', '投资理论与实务'),
('FIN103', '公司金融', 18, 3.0, 48, '选修', '公司财务管理'),
('FIN104', '金融市场学', 18, 3.0, 48, '选修', '金融市场分析'),

-- 市场营销专业课程
('MKT101', '市场营销学', 19, 3.0, 48, '必修', '市场营销基础'),
('MKT102', '消费者行为学', 19, 3.0, 48, '必修', '消费者心理分析'),
('MKT103', '品牌管理', 19, 3.0, 48, '选修', '品牌策略与管理'),
('MKT104', '数字营销', 19, 3.0, 48, '选修', '网络营销方法'),

-- 机械工程课程
('ME101', '机械制图', 20, 3.0, 48, '必修', '工程制图基础'),
('ME102', '理论力学', 20, 4.0, 64, '必修', '力学基础理论'),
('ME103', '材料力学', 20, 4.0, 64, '必修', '材料力学分析'),
('ME104', '机械设计', 20, 4.0, 64, '必修', '机械零件设计'),
('ME105', '机械制造技术', 20, 3.0, 48, '选修', '机械加工工艺'),

-- 公共基础课程
('PUB101', '思想道德修养与法律基础', 1, 3.0, 48, '必修', '思政课程'),
('PUB102', '中国近现代史纲要', 1, 2.0, 32, '必修', '历史课程'),
('PUB103', '马克思主义基本原理', 1, 3.0, 48, '必修', '马克思主义理论'),
('PUB104', '毛泽东思想和中国特色社会主义理论体系概论', 1, 4.0, 64, '必修', '思政理论课'),
('PUB105', '大学语文', 1, 2.0, 32, '必修', '语文基础'),
('PUB106', '大学英语I', 1, 4.0, 64, '必修', '英语基础'),
('PUB107', '大学英语II', 1, 4.0, 64, '必修', '英语提高'),
('PUB108', '大学英语III', 1, 4.0, 64, '必修', '英语强化'),
('PUB109', '大学英语IV', 1, 4.0, 64, '必修', '英语应用'),
('PUB110', '体育I', 1, 1.0, 32, '必修', '体育基础'),
('PUB111', '体育II', 1, 1.0, 32, '必修', '体育提高'),
('PUB112', '体育III', 1, 1.0, 32, '必修', '体育专项'),
('PUB113', '体育IV', 1, 1.0, 32, '必修', '体育选修'),
('PUB114', '计算机应用基础', 1, 3.0, 48, '必修', '计算机基础操作'),
('PUB115', '大学物理', 1, 4.0, 64, '必修', '物理学基础'),
('PUB116', '大学物理实验', 1, 1.0, 32, '必修', '物理实验'),
('PUB117', '军事理论', 1, 2.0, 32, '必修', '军事国防教育'),
('PUB118', '形势与政策', 1, 1.0, 16, '必修', '时事政策教育'),

-- 通识选修课程
('GE101', '音乐欣赏', 1, 2.0, 32, '公选', '音乐艺术欣赏'),
('GE102', '美术欣赏', 1, 2.0, 32, '公选', '美术艺术欣赏'),
('GE103', '文学欣赏', 1, 2.0, 32, '公选', '文学作品赏析'),
('GE104', '心理健康教育', 1, 2.0, 32, '公选', '心理健康指导'),
('GE105', '创新创业基础', 1, 2.0, 32, '公选', '创新创业教育'),
('GE106', '环境保护概论', 1, 2.0, 32, '公选', '环保意识教育'),
('GE107', '科技发展史', 1, 2.0, 32, '公选', '科技发展历程'),
('GE108', '逻辑学基础', 1, 2.0, 32, '公选', '逻辑思维训练'),
('GE109', '演讲与口才', 1, 2.0, 32, '公选', '演讲技巧训练'),
('GE110', '书法艺术', 1, 2.0, 32, '公选', '书法技艺学习');

-- ========================================
-- 6. 插入用户数据 (2000条)
-- ========================================

-- 插入管理员用户
INSERT INTO user (username, password, email, phone, real_name, status) VALUES
('admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'admin@school.edu.cn', '13800000001', '系统管理员', 1),
('academic_admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'academic@school.edu.cn', '13800000002', '教务管理员', 1),
('student_admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'student_admin@school.edu.cn', '13800000003', '学生管理员', 1);

-- 插入教师用户 (200个)
INSERT INTO user (username, password, email, phone, real_name, status) VALUES
('teacher001', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'teacher001@school.edu.cn', '13801000001', '张教授', 1),
('teacher002', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'teacher002@school.edu.cn', '13801000002', '李副教授', 1),
('teacher003', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'teacher003@school.edu.cn', '13801000003', '王讲师', 1),
('teacher004', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'teacher004@school.edu.cn', '13801000004', '刘教授', 1),
('teacher005', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'teacher005@school.edu.cn', '13801000005', '陈副教授', 1);

-- 批量插入更多教师用户
DELIMITER //
CREATE PROCEDURE InsertTeacherUsers()
BEGIN
    DECLARE i INT DEFAULT 6;
    DECLARE teacher_names JSON DEFAULT JSON_ARRAY('赵', '钱', '孙', '李', '周', '吴', '郑', '王', '冯', '陈', '褚', '卫', '蒋', '沈', '韩', '杨', '朱', '秦', '尤', '许', '何', '吕', '施', '张', '孔', '曹', '严', '华', '金', '魏', '陶', '姜', '戚', '谢', '邹', '喻', '柏', '水', '窦', '章', '云', '苏', '潘', '葛', '奚', '范', '彭', '郎', '鲁', '韦');
    DECLARE titles JSON DEFAULT JSON_ARRAY('教授', '副教授', '讲师', '助教');
    
    WHILE i <= 200 DO
        SET @username = CONCAT('teacher', LPAD(i, 3, '0'));
        SET @email = CONCAT(@username, '@school.edu.cn');
        SET @phone = CONCAT('1380100', LPAD(i, 4, '0'));
        SET @real_name = CONCAT(JSON_UNQUOTE(JSON_EXTRACT(teacher_names, CONCAT('$[', FLOOR(RAND() * 50), ']'))), 
                               CASE FLOOR(RAND() * 4)
                                   WHEN 0 THEN '教授'
                                   WHEN 1 THEN '副教授'
                                   WHEN 2 THEN '讲师'
                                   ELSE '助教'
                               END);
        
        INSERT INTO user (username, password, email, phone, real_name, status) VALUES
        (@username, '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', @email, @phone, @real_name, 1);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertTeacherUsers();
DROP PROCEDURE InsertTeacherUsers;

-- 批量插入学生用户 (1800个)
DELIMITER //
CREATE PROCEDURE InsertStudentUsers()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE student_surnames JSON DEFAULT JSON_ARRAY('王', '李', '张', '刘', '陈', '杨', '黄', '赵', '周', '吴', '徐', '孙', '朱', '马', '胡', '郭', '林', '何', '高', '梁', '郑', '罗', '宋', '谢', '唐', '韩', '曹', '许', '邓', '萧', '冯', '曾', '程', '蔡', '彭', '潘', '袁', '于', '董', '余', '苏', '叶', '吕', '魏', '蒋', '田', '杜', '丁', '沈', '姜');
    DECLARE student_names JSON DEFAULT JSON_ARRAY('伟', '芳', '娜', '秀英', '敏', '静', '丽', '强', '磊', '军', '洋', '勇', '艳', '杰', '娟', '涛', '明', '超', '秀兰', '霞', '平', '刚', '桂英', '建华', '文', '华', '金凤', '素梅', '建国', '丽娟', '春梅', '淑兰', '桂兰', '秀梅', '丽华', '志强', '秀珍', '建军', '海燕', '志明', '春兰', '建平', '桂珍', '志华', '秀华', '丽萍', '志勇', '桂花', '志刚', '海英');
    
    WHILE i <= 1800 DO
        SET @username = CONCAT('student', LPAD(i, 4, '0'));
        SET @email = CONCAT(@username, '@stu.school.edu.cn');
        SET @phone = CONCAT('1390100', LPAD(i, 4, '0'));
        SET @real_name = CONCAT(
            JSON_UNQUOTE(JSON_EXTRACT(student_surnames, CONCAT('$[', FLOOR(RAND() * 50), ']'))),
            JSON_UNQUOTE(JSON_EXTRACT(student_names, CONCAT('$[', FLOOR(RAND() * 50), ']')))
        );
        
        INSERT INTO user (username, password, email, phone, real_name, status) VALUES
        (@username, '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', @email, @phone, @real_name, 1);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertStudentUsers();
DROP PROCEDURE InsertStudentUsers;

-- ========================================
-- 7. 插入教师数据 (200条)
-- ========================================
INSERT INTO teacher (user_id, teacher_no, dept_id, title, hire_date, status) VALUES
-- 计算机学院教师
(4, 'T202100001', 6, '教授', '2015-09-01', 1),
(5, 'T202100002', 6, '副教授', '2017-09-01', 1),
(6, 'T202100003', 6, '讲师', '2019-09-01', 1),
(7, 'T202100004', 7, '教授', '2014-09-01', 1),
(8, 'T202100005', 7, '副教授', '2018-09-01', 1);

-- 批量插入其余教师数据
DELIMITER //
CREATE PROCEDURE InsertTeachers()
BEGIN
    DECLARE i INT DEFAULT 6;
    DECLARE dept_ids JSON DEFAULT JSON_ARRAY(6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20);
    DECLARE titles JSON DEFAULT JSON_ARRAY('教授', '副教授', '讲师', '助教');
    
    WHILE i <= 200 DO
        SET @user_id = i + 3; -- 用户ID从4开始，教师从第4个用户开始
        SET @teacher_no = CONCAT('T2021', LPAD(i, 5, '0'));
        SET @dept_id = JSON_UNQUOTE(JSON_EXTRACT(dept_ids, CONCAT('$[', FLOOR(RAND() * 15), ']')));
        SET @title = JSON_UNQUOTE(JSON_EXTRACT(titles, CONCAT('$[', FLOOR(RAND() * 4), ']')));
        SET @hire_date = DATE_ADD('2010-09-01', INTERVAL FLOOR(RAND() * 12) YEAR);
        
        INSERT INTO teacher (user_id, teacher_no, dept_id, title, hire_date, status) VALUES
        (@user_id, @teacher_no, @dept_id, @title, @hire_date, 1);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertTeachers();
DROP PROCEDURE InsertTeachers;

-- ========================================
-- 8. 插入学生数据 (1800条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertStudents()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE dept_ids JSON DEFAULT JSON_ARRAY(6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20);
    DECLARE grades JSON DEFAULT JSON_ARRAY(2020, 2021, 2022, 2023, 2024);
    DECLARE class_names JSON DEFAULT JSON_ARRAY('1班', '2班', '3班', '4班', '5班');
    
    WHILE i <= 1800 DO
        SET @user_id = i + 203; -- 学生用户从第204个用户开始
        SET @student_no = CONCAT(JSON_UNQUOTE(JSON_EXTRACT(grades, CONCAT('$[', FLOOR(RAND() * 5), ']'))), LPAD(i, 6, '0'));
        SET @dept_id = JSON_UNQUOTE(JSON_EXTRACT(dept_ids, CONCAT('$[', FLOOR(RAND() * 15), ']')));
        SET @grade = JSON_UNQUOTE(JSON_EXTRACT(grades, CONCAT('$[', FLOOR(RAND() * 5), ']')));
        SET @class_name = JSON_UNQUOTE(JSON_EXTRACT(class_names, CONCAT('$[', FLOOR(RAND() * 5), ']')));
        SET @enrollment_year = @grade;
        SET @graduation_year = @grade + 4;
        
        INSERT INTO student (user_id, student_no, dept_id, class_name, grade, enrollment_year, graduation_year) VALUES
        (@user_id, @student_no, @dept_id, @class_name, @grade, @enrollment_year, @graduation_year);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertStudents();
DROP PROCEDURE InsertStudents;

-- ========================================
-- 9. 插入开课数据 (500条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertCourseOfferings()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE semesters JSON DEFAULT JSON_ARRAY('2023-2024-1', '2023-2024-2', '2024-2025-1', '2024-2025-2');
    
    WHILE i <= 500 DO
        SET @course_id = FLOOR(RAND() * 120) + 1; -- 随机选择课程
        SET @teacher_id = FLOOR(RAND() * 200) + 1; -- 随机选择教师
        SET @semester = JSON_UNQUOTE(JSON_EXTRACT(semesters, CONCAT('$[', FLOOR(RAND() * 4), ']')));
        SET @max_students = 30 + FLOOR(RAND() * 71); -- 30-100人
        
        INSERT IGNORE INTO course_offering (course_id, teacher_id, semester, max_students, current_students, status) VALUES
        (@course_id, @teacher_id, @semester, @max_students, 0, 1);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertCourseOfferings();
DROP PROCEDURE InsertCourseOfferings;

-- ========================================
-- 10. 插入选课数据 (5000条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertEnrollments()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE max_offering_id INT;
    
    SELECT MAX(offering_id) INTO max_offering_id FROM course_offering;
    
    WHILE i <= 5000 DO
        SET @student_id = FLOOR(RAND() * 1800) + 1;
        SET @offering_id = FLOOR(RAND() * max_offering_id) + 1;
        SET @enrollment_date = DATE_SUB(NOW(), INTERVAL FLOOR(RAND() * 365) DAY);
        
        INSERT IGNORE INTO enrollment (student_id, offering_id, enrollment_date, status) VALUES
        (@student_id, @offering_id, @enrollment_date, 1);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertEnrollments();
DROP PROCEDURE InsertEnrollments;

-- ========================================
-- 11. 插入成绩数据 (4000条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertGrades()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE max_enrollment_id INT;
    DECLARE random_teacher_id INT;
    
    SELECT MAX(enrollment_id) INTO max_enrollment_id FROM enrollment;
    
    WHILE i <= 4000 DO
        SET @enrollment_id = FLOOR(RAND() * max_enrollment_id) + 1;
        SET @usual_score = 60 + FLOOR(RAND() * 41); -- 60-100分
        SET @exam_score = 50 + FLOOR(RAND() * 51); -- 50-100分
        SET random_teacher_id = FLOOR(RAND() * 200) + 1;
        
        -- 检查该选课记录是否存在
        IF EXISTS(SELECT 1 FROM enrollment WHERE enrollment_id = @enrollment_id) THEN
            INSERT IGNORE INTO grade (enrollment_id, usual_score, exam_score, recorded_by, recorded_at) VALUES
            (@enrollment_id, @usual_score, @exam_score, random_teacher_id, DATE_SUB(NOW(), INTERVAL FLOOR(RAND() * 180) DAY));
        END IF;
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertGrades();
DROP PROCEDURE InsertGrades;

-- ========================================
-- 12. 插入排课数据 (800条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertSchedules()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE max_offering_id INT;
    DECLARE max_classroom_id INT;
    DECLARE time_slots JSON DEFAULT JSON_ARRAY('08:00:00', '10:00:00', '14:00:00', '16:00:00', '19:00:00');
    DECLARE end_times JSON DEFAULT JSON_ARRAY('09:40:00', '11:40:00', '15:40:00', '17:40:00', '20:40:00');
    
    SELECT MAX(offering_id) INTO max_offering_id FROM course_offering;
    SELECT MAX(classroom_id) INTO max_classroom_id FROM classroom;
    
    WHILE i <= 800 DO
        SET @offering_id = FLOOR(RAND() * max_offering_id) + 1;
        SET @classroom_id = FLOOR(RAND() * max_classroom_id) + 1;
        SET @day_of_week = FLOOR(RAND() * 5) + 1; -- 周一到周五
        SET @time_index = FLOOR(RAND() * 5);
        SET @start_time = JSON_UNQUOTE(JSON_EXTRACT(time_slots, CONCAT('$[', @time_index, ']')));
        SET @end_time = JSON_UNQUOTE(JSON_EXTRACT(end_times, CONCAT('$[', @time_index, ']')));
        SET @weeks = CONCAT('1-', 16 + FLOOR(RAND() * 4)); -- 1-16到1-19周
        
        INSERT IGNORE INTO schedule (offering_id, classroom_id, day_of_week, start_time, end_time, weeks) VALUES
        (@offering_id, @classroom_id, @day_of_week, @start_time, @end_time, @weeks);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertSchedules();
DROP PROCEDURE InsertSchedules;

-- ========================================
-- 13. 插入奖惩记录 (300条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertRewardPunishments()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE reward_categories JSON DEFAULT JSON_ARRAY('三好学生', '优秀学生干部', '学习优秀奖', '科技创新奖', '体育优秀奖', '文艺优秀奖', '志愿服务奖');
    DECLARE punishment_categories JSON DEFAULT JSON_ARRAY('违纪警告', '严重警告', '记过', '留校察看', '考试作弊', '旷课处分');
    
    WHILE i <= 300 DO
        SET @student_id = FLOOR(RAND() * 1800) + 1;
        SET @type = IF(RAND() > 0.3, '奖励', '惩罚'); -- 70%奖励，30%惩罚
        
        IF @type = '奖励' THEN
            SET @category = JSON_UNQUOTE(JSON_EXTRACT(reward_categories, CONCAT('$[', FLOOR(RAND() * 7), ']')));
            SET @description = CONCAT('因表现优秀，授予', @category);
        ELSE
            SET @category = JSON_UNQUOTE(JSON_EXTRACT(punishment_categories, CONCAT('$[', FLOOR(RAND() * 6), ']')));
            SET @description = CONCAT('因违反校规校纪，给予', @category);
        END IF;
        
        SET @occur_date = DATE_SUB(NOW(), INTERVAL FLOOR(RAND() * 730) DAY);
        SET @handler_id = FLOOR(RAND() * 3) + 1; -- 管理员处理
        
        INSERT INTO reward_punishment (student_id, type, category, description, occur_date, handler_id) VALUES
        (@student_id, @type, @category, @description, @occur_date, @handler_id);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertRewardPunishments();
DROP PROCEDURE InsertRewardPunishments;

-- ========================================
-- 14. 插入学籍状态记录 (2000条)
-- ========================================
DELIMITER //
CREATE PROCEDURE InsertStudentStatus()
BEGIN
    DECLARE i INT DEFAULT 1;
    DECLARE status_types JSON DEFAULT JSON_ARRAY('在读', '休学', '复学', '转学', '退学', '毕业');
    DECLARE reasons JSON DEFAULT JSON_ARRAY('正常在读', '因病休学', '因事休学', '休学期满复学', '转专业', '转学至其他学校', '学业完成毕业', '提前毕业', '延期毕业');
    
    WHILE i <= 2000 DO
        SET @student_id = FLOOR(RAND() * 1800) + 1;
        SET @status_type = JSON_UNQUOTE(JSON_EXTRACT(status_types, CONCAT('$[', FLOOR(RAND() * 6), ']')));
        SET @effective_date = DATE_SUB(NOW(), INTERVAL FLOOR(RAND() * 1460) DAY);
        
        CASE @status_type
            WHEN '在读' THEN SET @reason = '正常在读';
            WHEN '休学' THEN SET @reason = IF(RAND() > 0.5, '因病休学', '因事休学');
            WHEN '复学' THEN SET @reason = '休学期满复学';
            WHEN '转学' THEN SET @reason = '转学至其他学校';
            WHEN '退学' THEN SET @reason = '学业原因退学';
            WHEN '毕业' THEN SET @reason = IF(RAND() > 0.8, '提前毕业', IF(RAND() > 0.1, '正常毕业', '延期毕业'));
        END CASE;
        
        SET @handler_id = FLOOR(RAND() * 3) + 1;
        
        INSERT INTO student_status (student_id, status_type, effective_date, reason, handler_id) VALUES
        (@student_id, @status_type, @effective_date, @reason, @handler_id);
        
        SET i = i + 1;
    END WHILE;
END//
DELIMITER ;

CALL InsertStudentStatus();
DROP PROCEDURE InsertStudentStatus;

-- ========================================
-- 15. 配置用户角色关系
-- ========================================

-- 为管理员分配角色
INSERT INTO user_role (user_id, role_id, assigned_by) VALUES
(1, 1, 1), -- 超级管理员
(2, 2, 1), -- 教务管理员
(3, 3, 1); -- 学生管理员

-- 为教师分配角色
INSERT INTO user_role (user_id, role_id, assigned_by)
SELECT user_id, 4, 1 FROM teacher WHERE user_id IS NOT NULL;

-- 为学生分配角色
INSERT INTO user_role (user_id, role_id, assigned_by)
SELECT user_id, 5, 1 FROM student WHERE user_id IS NOT NULL;

-- ========================================
-- 16. 配置角色权限关系
-- ========================================

-- 超级管理员拥有所有权限
INSERT INTO role_permission (role_id, permission_id)
SELECT 1, permission_id FROM permission;

-- 教务管理员权限
INSERT INTO role_permission (role_id, permission_id)
SELECT 2, permission_id FROM permission 
WHERE permission_code IN (
    'COURSE_MANAGE', 'COURSE_CREATE', 'COURSE_UPDATE', 'COURSE_DELETE', 'COURSE_VIEW', 'COURSE_EDIT',
    'COURSE_OFFERING_MANAGE', 'COURSE_OFFERING_CREATE', 'COURSE_OFFERING_UPDATE', 'COURSE_OFFERING_DELETE', 'COURSE_OFFERING_VIEW', 'COURSE_OFFERING_EDIT',
    'ENROLLMENT_MANAGE', 'ENROLLMENT_APPROVE', 'ENROLLMENT_VIEW', 'ENROLLMENT_CREATE', 'ENROLLMENT_EDIT', 'ENROLLMENT_DELETE',
    'GRADE_MANAGE', 'GRADE_INPUT', 'GRADE_UPDATE', 'GRADE_VIEW', 'GRADE_EDIT',
    'SCHEDULE_MANAGE', 'SCHEDULE_CREATE', 'SCHEDULE_UPDATE', 'SCHEDULE_DELETE', 'SCHEDULE_VIEW', 'SCHEDULE_EDIT',
    'TEACHER_VIEW', 'STUDENT_VIEW', 'CLASSROOM_MANAGE'
);

-- 学生管理员权限
INSERT INTO role_permission (role_id, permission_id)
SELECT 3, permission_id FROM permission 
WHERE permission_code IN (
    'STUDENT_MANAGE', 'STUDENT_VIEW', 'STUDENT_CREATE', 'STUDENT_EDIT', 'STUDENT_DELETE',
    'STUDENT_STATUS_MANAGE', 'STUDENT_STATUS_UPDATE', 'STUDENT_STATUS_VIEW',
    'REWARD_PUNISHMENT_MANAGE', 'REWARD_PUNISHMENT_CREATE', 'REWARD_PUNISHMENT_UPDATE', 'REWARD_PUNISHMENT_DELETE', 'REWARD_PUNISHMENT_VIEW',
    'ENROLLMENT_VIEW', 'GRADE_VIEW'
);

-- 教师权限
INSERT INTO role_permission (role_id, permission_id)
SELECT 4, permission_id FROM permission 
WHERE permission_code IN (
    'MY_COURSES_VIEW', 'STUDENT_LIST_VIEW', 'GRADE_INPUT', 'GRADE_UPDATE', 'GRADE_VIEW', 'GRADE_EDIT',
    'ENROLLMENT_VIEW', 'SCHEDULE_VIEW'
);

-- 学生权限
INSERT INTO role_permission (role_id, permission_id)
SELECT 5, permission_id FROM permission 
WHERE permission_code IN (
    'MY_ENROLLMENT_VIEW', 'MY_GRADE_VIEW', 'COURSE_VIEW', 'COURSE_OFFERING_VIEW', 'SCHEDULE_VIEW'
);

-- ========================================
-- 17. 数据统计和验证
-- ========================================

-- 显示数据统计
SELECT '数据插入完成，统计信息如下：' as message;

SELECT 
    '用户数据' as table_name,
    COUNT(*) as record_count
FROM user
UNION ALL
SELECT 
    '权限数据' as table_name,
    COUNT(*) as record_count
FROM permission
UNION ALL
SELECT 
    '角色数据' as table_name,
    COUNT(*) as record_count
FROM role
UNION ALL
SELECT 
    '部门数据' as table_name,
    COUNT(*) as record_count
FROM department
UNION ALL
SELECT 
    '教室数据' as table_name,
    COUNT(*) as record_count
FROM classroom
UNION ALL
SELECT 
    '课程数据' as table_name,
    COUNT(*) as record_count
FROM course
UNION ALL
SELECT 
    '教师数据' as table_name,
    COUNT(*) as record_count
FROM teacher
UNION ALL
SELECT 
    '学生数据' as table_name,
    COUNT(*) as record_count
FROM student
UNION ALL
SELECT 
    '开课数据' as table_name,
    COUNT(*) as record_count
FROM course_offering
UNION ALL
SELECT 
    '选课数据' as table_name,
    COUNT(*) as record_count
FROM enrollment
UNION ALL
SELECT 
    '成绩数据' as table_name,
    COUNT(*) as record_count
FROM grade
UNION ALL
SELECT 
    '排课数据' as table_name,
    COUNT(*) as record_count
FROM schedule
UNION ALL
SELECT 
    '奖惩数据' as table_name,
    COUNT(*) as record_count
FROM reward_punishment
UNION ALL
SELECT 
    '学籍状态数据' as table_name,
    COUNT(*) as record_count
FROM student_status
UNION ALL
SELECT 
    '用户角色关系' as table_name,
    COUNT(*) as record_count
FROM user_role
UNION ALL
SELECT 
    '角色权限关系' as table_name,
    COUNT(*) as record_count
FROM role_permission;

-- 计算总记录数
SELECT 
    'Total Records' as summary,
    (SELECT COUNT(*) FROM user) +
    (SELECT COUNT(*) FROM permission) +
    (SELECT COUNT(*) FROM role) +
    (SELECT COUNT(*) FROM department) +
    (SELECT COUNT(*) FROM classroom) +
    (SELECT COUNT(*) FROM course) +
    (SELECT COUNT(*) FROM teacher) +
    (SELECT COUNT(*) FROM student) +
    (SELECT COUNT(*) FROM course_offering) +
    (SELECT COUNT(*) FROM enrollment) +
    (SELECT COUNT(*) FROM grade) +
    (SELECT COUNT(*) FROM schedule) +
    (SELECT COUNT(*) FROM reward_punishment) +
    (SELECT COUNT(*) FROM student_status) +
    (SELECT COUNT(*) FROM user_role) +
    (SELECT COUNT(*) FROM role_permission) as total_count;

-- ========================================
-- 18. 创建一些有用的查询示例
-- ========================================

-- 查看各专业学生人数统计
SELECT 
    d.dept_name as '专业名称',
    COUNT(s.student_id) as '学生人数',
    COUNT(CASE WHEN s.grade = 2024 THEN 1 END) as '2024级',
    COUNT(CASE WHEN s.grade = 2023 THEN 1 END) as '2023级',
    COUNT(CASE WHEN s.grade = 2022 THEN 1 END) as '2022级',
    COUNT(CASE WHEN s.grade = 2021 THEN 1 END) as '2021级',
    COUNT(CASE WHEN s.grade = 2020 THEN 1 END) as '2020级'
FROM department d
LEFT JOIN student s ON d.dept_id = s.dept_id
WHERE d.parent_id IS NOT NULL
GROUP BY d.dept_id, d.dept_name
ORDER BY COUNT(s.student_id) DESC;

-- 查看各学院教师人数统计
SELECT 
    d.dept_name as '学院名称',
    COUNT(t.teacher_id) as '教师人数',
    COUNT(CASE WHEN t.title = '教授' THEN 1 END) as '教授',
    COUNT(CASE WHEN t.title = '副教授' THEN 1 END) as '副教授',
    COUNT(CASE WHEN t.title = '讲师' THEN 1 END) as '讲师',
    COUNT(CASE WHEN t.title = '助教' THEN 1 END) as '助教'
FROM department d
LEFT JOIN teacher t ON d.dept_id = t.dept_id
WHERE d.parent_id IS NULL
GROUP BY d.dept_id, d.dept_name
ORDER BY COUNT(t.teacher_id) DESC;

-- 查看课程开设情况统计
SELECT 
    co.semester as '学期',
    COUNT(co.offering_id) as '开课门数',
    SUM(co.max_students) as '计划招生人数',
    SUM(co.current_students) as '实际选课人数',
    ROUND(SUM(co.current_students) / SUM(co.max_students) * 100, 2) as '选课率%'
FROM course_offering co
GROUP BY co.semester
ORDER BY co.semester;

-- 查看成绩分布统计
SELECT 
    '优秀(90-100)' as '成绩等级',
    COUNT(*) as '人数',
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM grade WHERE final_score IS NOT NULL), 2) as '占比%'
FROM grade 
WHERE final_score >= 90 AND final_score IS NOT NULL
UNION ALL
SELECT 
    '良好(80-89)' as '成绩等级',
    COUNT(*) as '人数',
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM grade WHERE final_score IS NOT NULL), 2) as '占比%'
FROM grade 
WHERE final_score >= 80 AND final_score < 90
UNION ALL
SELECT 
    '中等(70-79)' as '成绩等级',
    COUNT(*) as '人数',
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM grade WHERE final_score IS NOT NULL), 2) as '占比%'
FROM grade 
WHERE final_score >= 70 AND final_score < 80
UNION ALL
SELECT 
    '及格(60-69)' as '成绩等级',
    COUNT(*) as '人数',
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM grade WHERE final_score IS NOT NULL), 2) as '占比%'
FROM grade 
WHERE final_score >= 60 AND final_score < 70
UNION ALL
SELECT 
    '不及格(<60)' as '成绩等级',
    COUNT(*) as '人数',
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM grade WHERE final_score IS NOT NULL), 2) as '占比%'
FROM grade 
WHERE final_score < 60;

-- 提交事务
COMMIT;

-- 显示完成信息
SELECT 
    '数据插入完成！' as status,
    '总记录数超过10,000条' as description,
    NOW() as completion_time;

```

